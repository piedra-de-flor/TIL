# Operational Transformation (OT) vs. CRDT

## 목적
실시간 협업 시스템에서 **여러 사용자의 동시 편집을 병합**할 수 있도록 지원하는 알고리즘

---

## OT (Operational Transformation)

### 개념
- 편집 연산(Operation)을 상대 사용자의 작업에 맞게 **Transform**하여 적용
- 편집 순서가 달라도 최종 결과를 **일관성 있게 유지**

### 핵심 구성 요소
1. **Operation (op)**: 삽입, 삭제 등 편집 작업
2. **Transform(op1, op2)**: 동시 작업을 서로 보정하는 함수
3. **History Buffer**: 이전 작업 순서를 기억하여 Transform 기준 확보

### 작동 예시
- 초기 상태: `"ABC"`
- 사용자 A: index 1에 `"X"` 삽입 → `"AXBC"`
- 사용자 B: index 2에 `"Y"` 삽입 → `"ABYC"`

충돌 시, OT는 서로의 연산을 **상대 위치 기준으로 변환**:

**A 삽입 → B 위치를 1 증가 → 최종: "AXBYC"**


### 장점
- 문서 기반 편집에 매우 효율적
- 빠른 실시간 반응성 (Google Docs 수준)

### 단점
- 중앙 서버 필요 (중앙 집중형 구조)
- 클라이언트 수 증가에 따라 Transform 함수 복잡도 증가
- 서버/클라이언트 간 시간 동기화 필요

---

## CRDT (Conflict-free Replicated Data Type)

### 개념
- 연산 결과를 **자동 병합이 가능한 자료구조로 표현**
- 각 노드가 병합 연산(`⊔`)을 통해 **충돌 없이 동기화 가능**

### 수학적 기반
- 병합 연산이 다음을 만족해야 함:
    - **결합법칙**: (a ⊔ b) ⊔ c = a ⊔ (b ⊔ c)
    - **교환법칙**: a ⊔ b = b ⊔ a
    - **항등원**: a ⊔ ⊥ = a

### 대표 CRDT 종류

| 종류               | 설명                                | 예시                       |
|--------------------|-------------------------------------|----------------------------|
| G-Counter          | 증가만 가능한 정수                  | 좋아요 수, 방문 횟수       |
| OR-Set             | 중복 삽입/삭제 가능한 집합          | 태그 관리                  |
| RGA (Replicated Growable Array) | 텍스트 삽입/삭제용 동기화 가능한 배열 | 협업 에디터 (Figma 등)    |
| LWW-Register       | 최종 쓰기 기준값 유지                | 설정값 관리                |

### 작동 예시 (RGA)
- 각 문자는 (timestamp, clientId)로 식별
- 충돌 시 ID 기준으로 정렬

```txt
사용자 A: "X" 삽입 @ timestamp 100
사용자 B: "Y" 삽입 @ timestamp 101

→ 자동 병합 결과: "XY" (시간순 정렬)
```